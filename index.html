<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zekecraft Web 1.2</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #87CEEB; /* Sky blue */
        }

        canvas {
            display: block;
        }

        #gameMenu {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        #gameMenu button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="gameMenu">
        <h1>Game Menu</h1>
        <button onclick="resumeGame()">Resume</button>
        <button onclick="saveWorld()">Save World</button>
        <button onclick="loadWorld()">Load World</button>
        <button onclick="exitGame()">Exit</button>
    </div>
    <script>
        // Initialize Three.js Scene
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('gameCanvas') });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Lighting
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(10, 10, 10);
        scene.add(light);

        // Texture Loader
        const textureLoader = new THREE.TextureLoader();
        const blockTypes = {
            grass: textureLoader.load('textures/grass_block.png'),
            dirt: textureLoader.load('textures/dirt_block.png'),
            stone: textureLoader.load('textures/stone_block.png'),
            sand: textureLoader.load('textures/sand_block.png'),
            water: textureLoader.load('textures/water_block.png'),
            lava: textureLoader.load('textures/lava_block.png'),
            oak_log: textureLoader.load('textures/oak_log.png'),
            ice: textureLoader.load('textures/ice_block.png'),
            netherrack: textureLoader.load('textures/netherrack_block.png'),
            glowstone: textureLoader.load('textures/glowstone_block.png'),
            soul_sand: textureLoader.load('textures/soul_sand.png'),
            mossy_cobblestone: textureLoader.load('textures/mossy_cobblestone.png'),
            subscribe_to_zeke: textureLoader.load('textures/subscribe_block.png') // Special block
        };

        // Function to Create Blocks
        const createBlock = (x, y, z, texture, specialAction = null) => {
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.MeshBasicMaterial({ map: texture });
            const block = new THREE.Mesh(geometry, material);
            block.position.set(x, y, z);
            scene.add(block);

            // Add special action for the block (right-click)
            if (specialAction) {
                block.userData = { action: specialAction };
            }
        };

        // Add Blocks to Scene
        createBlock(0, 0, 0, blockTypes.grass);
        createBlock(1, 0, 0, blockTypes.dirt);
        createBlock(2, 0, 0, blockTypes.stone);
        createBlock(3, 0, 0, blockTypes.sand);
        createBlock(4, 0, 0, blockTypes.water);
        createBlock(5, 0, 0, blockTypes.lava);
        createBlock(6, 0, 0, blockTypes.oak_log);
        createBlock(7, 0, 0, blockTypes.ice);
        createBlock(8, 0, 0, blockTypes.netherrack);
        createBlock(9, 0, 0, blockTypes.glowstone);
        createBlock(10, 0, 0, blockTypes.soul_sand);
        createBlock(11, 0, 0, blockTypes.mossy_cobblestone);
        createBlock(12, 0, 0, blockTypes.subscribe_to_zeke, () => {
            window.open('https://zeke-youtube.github.io/zeke-web', '_blank');
        });

        // Mouse Lock
        document.addEventListener('click', () => {
            const canvas = document.getElementById('gameCanvas');
            canvas.requestPointerLock();
        });

        document.addEventListener('mousemove', (event) => {
            if (document.pointerLockElement) {
                camera.rotation.y -= event.movementX * 0.002;
                camera.rotation.x -= event.movementY * 0.002;
            }
        });

        // Game Menu
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                document.exitPointerLock(); // Unlock mouse
                toggleGameMenu();
            }
        });

        function toggleGameMenu() {
            const menu = document.getElementById('gameMenu');
            if (menu.style.display === 'none') {
                menu.style.display = 'block';
            } else {
                menu.style.display = 'none';
            }
        }

        function resumeGame() {
            document.getElementById('gameMenu').style.display = 'none';
            document.getElementById('gameCanvas').requestPointerLock(); // Relock mouse
        }

        function saveWorld() {
            const blocks = [];
            scene.children.forEach(child => {
                if (child.geometry && child.material.map) {
                    blocks.push({
                        position: child.position,
                        texture: child.material.map.image.src // Save the texture path
                    });
                }
            });
            localStorage.setItem('zekecraftWorld', JSON.stringify(blocks));
            alert('World saved!');
        }

        function loadWorld() {
            const savedBlocks = JSON.parse(localStorage.getItem('zekecraftWorld') || '[]');
            savedBlocks.forEach(blockData => {
                const texture = textureLoader.load(blockData.texture);
                createBlock(blockData.position.x, blockData.position.y, blockData.position.z, texture);
            });
            alert('World loaded!');
        }

        function exitGame() {
            alert('Exiting Zekecraft...');
            window.close(); // Only works for tabs opened via script
        }

        // Camera Position
        camera.position.set(5, 5, 15);
        camera.lookAt(5, 0, 0);

        // Animate Scene
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
